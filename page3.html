<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>South West Fire Danger</title>
    <style>
        body { background-color: black; color: white; font-family: 'Segoe UI', Arial, sans-serif; padding: 40px; text-align: center; }
        .header { font-size: 2.5em; font-weight: bold; margin-bottom: 40px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        .container { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; }
        .day-column { flex: 1; min-width: 220px; max-width: 280px; background: #111; padding: 20px; border-radius: 15px; border: 1px solid #222; }
        .label { font-size: 1.4em; color: #aaa; margin-bottom: 5px; text-transform: uppercase; }
        .date-sub { font-size: 0.9em; color: #666; margin-bottom: 15px; display: block; }
        .map-img { width: 100%; height: auto; border-radius: 8px; margin-bottom: 15px; border: 1px solid #333; }
        .rating-text { font-size: 1.8em; font-weight: 900; letter-spacing: 1px; }

        /* Rating Colors */
        .MODERATE { color: #78be20; } 
        .HIGH { color: #ffb81c; } 
        .EXTREME { color: #e03c31; } 
        .CATASTROPHIC { color: #ffffff; text-shadow: 0 0 8px red; }
        .NO-RATING { color: #666; }

        .loading { font-style: italic; color: #888; margin-top: 50px; }
    </style>
</head>
<body>

    <div class="header">South West Fire Danger</div>
    <div id="content" class="container"><p class="loading">Connecting to CFA Live Feed...</p></div>

    <script>
        async function fetchFeed() {
            const rssUrl = "https://www.cfa.vic.gov.au/cfa/rssfeed/southwest-firedistrict_rss.xml";
            // Switched to allorigins proxy for better reliability
            const proxy = `https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`;
            
            try {
                const response = await fetch(proxy);
                if (!response.ok) throw new Error('Proxy unreachable');
                const data = await response.json();
                
                const parser = new DOMParser();
                const xml = parser.parseFromString(data.contents, "text/xml");
                const items = xml.querySelectorAll("item");
                
                if (items.length === 0) throw new Error('No data in feed');

                let html = '';
                const labels = ["Today", "Tomorrow", "Overmorrow", "Day 4"];
                
                for (let i = 0; i < 3; i++) {
                    const item = items[i];
                    const fullText = item.querySelector("description").textContent.toUpperCase();
                    const pubDate = item.querySelector("title").textContent.split('-')[0].trim(); // Extract date from title

                    let imgName = "norating.gif";
                    let rating = "NO RATING";
                    let colorClass = "NO-RATING";

                    if (fullText.includes("CATASTROPHIC")) { rating = "CATASTROPHIC"; imgName = "catastrophic.gif"; colorClass = "CATASTROPHIC"; }
                    else if (fullText.includes("EXTREME")) { rating = "EXTREME"; imgName = "extreme.gif"; colorClass = "EXTREME"; }
                    else if (fullText.includes("HIGH")) { rating = "HIGH"; imgName = "high.gif"; colorClass = "HIGH"; }
                    else if (fullText.includes("MODERATE")) { rating = "MODERATE"; imgName = "moderate.gif"; colorClass = "MODERATE"; }

                    const imgUrl = `https://www.cfa.vic.
